var myMarker,myMarker2,infowindow,infowindow2,contentString,contentString2;$(document).ready((function(){$("#settings").hide(),window.addEventListener("storage",(function(e){"logout-event"==e.key&&(window.location.href=""+localStorage.getItem("wh-user"))}))}));var markers=[],markers2=[];function initAutocomplete(){$.ajax({async:!0,type:"GET",url:urlForAll+"profile/get/profile/"+localStorage.getItem("userID"),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(e){e,document.getElementById("sender_address").value=e.data.sender_address,document.getElementById("pac-input").value=e.data.sender_address,document.getElementById("lat").value=e.data.sender_lat,document.getElementById("longi").value=e.data.sender_longi;for(var o=new google.maps.Map(document.getElementById("map"),{center:{lat:23.8103,lng:90.4125},zoom:13,mapTypeId:"roadmap",mapTypeControl:!1,fullscreenControl:!1}),t=[{position:{lat:parseFloat(e.data.sender_lat),lng:parseFloat(e.data.sender_longi)},type:"info"}],n=0;n<t.length;n++)new google.maps.Marker({position:t[n].position,icon:{url:"static/img/p5.png"},map:o});navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude};(new google.maps.Geocoder).geocode({location:t},(function(e,n){if("OK"===n)if(e[0])new google.maps.Marker({position:t,map:o,icon:{url:"http://maps.google.com/mapfiles/ms/icons/blue-dot.png"},title:"Your current location is : "+e[0].formatted_address});else window.alert("No results found");else window.alert("Geocoder failed due to: "+n)})),o.setCenter(t)}),(function(){}));var a=document.getElementById("pac-input"),r=new google.maps.places.SearchBox(a);o.controls[google.maps.ControlPosition.TOP_LEFT].push(a),o.addListener("bounds_changed",(function(){r.setBounds(o.getBounds())})),r.addListener("places_changed",(function(){var e=r.getPlaces();if(0!=e.length){var t=new google.maps.LatLngBounds;e.forEach((function(e){if(e.geometry){removeMarkers(),myMarker=new google.maps.Marker({position:e.geometry.location,draggable:!0}),markers.push(myMarker),contentString="<p>Drag marker...</p>",infowindow=new google.maps.InfoWindow({content:contentString});var n=new google.maps.Geocoder,r=new google.maps.LatLng(myMarker.position.lat(),myMarker.position.lng());n.geocode({latLng:r},(function(e,o){if(o==google.maps.GeocoderStatus.OK){var t=e[0].formatted_address;infowindow.setContent(t),document.getElementById("lat").value=myMarker.position.lat(),document.getElementById("longi").value=myMarker.position.lng()}})),google.maps.event.addListener(myMarker,"dragend",(function(e){contentString="<p>Current Lat: "+a+" Current Lng: "+e.latLng.lng().toFixed(3)+"</p>",document.getElementById("lat").value=e.latLng.lat(),document.getElementById("longi").value=e.latLng.lng();var o=new google.maps.Geocoder,t=new google.maps.LatLng(e.latLng.lat(),e.latLng.lng());o.geocode({latLng:t},(function(e,o){if(o==google.maps.GeocoderStatus.OK){var t=e[0].formatted_address;infowindow.setContent(t),document.getElementById("pac-input").value=t}}))})),google.maps.event.addListener(myMarker,"dragstart",(function(e){})),myMarker.addListener("click",(function(){infowindow.open(o,myMarker)})),o.setCenter(myMarker.position),myMarker.setMap(o),e.geometry.viewport?t.union(e.geometry.viewport):t.extend(e.geometry.location)}})),o.fitBounds(t)}}))},error:function(e,o,t){$("#myModal2").modal("show")}})}function removeMarkers(){for(var e=0;e<markers.length;e++)markers[e].setMap(null)}function handleLocationError(e,o,t){o.setPosition(t),o.setContent(e?"Error: The Geolocation service failed.":"Error: Your browser doesn't support geolocation."),o.open(map)}document.getElementById("updateMerchant").addEventListener("click",(function(e){e.preventDefault();var o=document.getElementById("sender_address").value,t=document.getElementById("pac-input").value,n=String(document.getElementById("lat").value),a=String(document.getElementById("longi").value);1==(""==o||null==o?(document.getElementById("wrongThisMerSet").innerHTML="Address cannot be empty!",$("#myModalWrongMerSet").modal("show"),0):1)&&1==(""==t||null==t?(document.getElementById("wrongThisMerSet").innerHTML="Please search your location on map!",$("#myModalWrongMerSet").modal("show"),0):1)&&1==(""==n||null==n?(document.getElementById("wrongThisMerSet").innerHTML="Please search your location on map!",$("#myModalWrongMerSet").modal("show"),0):1)&&$.ajax({type:"PUT",url:urlForAll+"profile/update/settings",data:JSON.stringify({user_id:localStorage.getItem("userID"),sender_address:o,sender_lat:n,sender_longi:a}),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(e){$("#tickDD2").hide(),$(".circle-loader").removeClass("load-complete"),$("#sureDD2").html(""),$("#myModalCreateDD1").modal("show"),$("#sureDD2").html("Please wait!"),"OK"==e.status&&(setTimeout((function(){$(".circle-loader").addClass("load-complete"),$("#tickDD2").show(),$("#sureDD2").html("Organization Settings Updated!")}),3e3),setTimeout((function(){$("#myModalCreateDD1").modal("hide")}),4e3),$("#cod").hide())},error:function(e,o,t){$("#myModalCreateDD1").modal("hide"),$("#myModal2").modal("show")}})}));