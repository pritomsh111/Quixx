var orgid,deliveryManId,$t,manager_ID=localStorage.getItem("userID"),createDelivery=()=>{$("#dtBasicExample").hide(),$(".a").hide(),$("#dtBasicExampleAp").hide(),$("#dtBasicExampleNew").hide(),$(".b").hide(),$(".c").show(),$(".d").hide(),$(".e").hide(),$("#dtBasicExampled").hide(),$("#deliveryCreate").show()},goToDelivery=()=>{window.open("addDeliverToDeliveryMan.html","_blank")},unassignedDeliveries=()=>{$("#dtBasicExample").hide(),$(".a").hide(),$("#dtBasicExampleAp").hide(),$("#dtBasicExampleNew").hide(),$(".b").hide(),$(".c").hide(),$(".d").hide(),$(".e").hide(),$("#dtBasicExampled").hide(),$("#deliveryCreate").hide(),$.ajax({url:urlForAll+"deliveryMan/approved/"+manager_ID,type:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(e){$("#deliveryManList").empty().append('<option selected="selected" value="">Delivery Man List</option>');for(var t=0;t<e.data.length;t++){var a=new Option(e.data[t].delivery_man_id,e.data[t].delivery_man_id);$(a).html(e.data[t].name),$("#deliveryManList").append(a)}}});var e=$("#dtBasicExampled").DataTable({processing:!0,destroy:!0});e.clear().draw(),$.ajax({async:!1,type:"GET",cors:!0,contentType:"application/json",secure:!0,crossDomain:!0,url:urlForAll+"manager/all/unAssign/delivery/"+manager_ID,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(t){document.getElementById("onee").innerHTML="Unassigned Deliveries: "+t.data.length;$.each(t.data,(function(a,d){var n="<tr><td>"+t.data[a].delivery_Id+"</td><td>"+t.data[a].pickup_time+"</td><td>"+t.data[a].sender_name+"</td><td>"+t.data[a].sender_phone_number+"</td><td>"+t.data[a].sender_address+"</td><td>"+t.data[a].receiver_name+"</td><td>"+t.data[a].receiver_phone_number+"</td><td>"+t.data[a].delivery_area+"</td><td>"+t.data[a].receiver_address+"</td><td>"+t.data[a].delivery_type+"</td><td>"+t.data[a].delivery_charge+"</td><td>"+t.data[a].payment_method+"</td><td>"+t.data[a].delivery_note+'</td><td><button id="'+t.data[a].delivery_Id+'" class="btn-round btn-outline btn assignIt">Assign</button></td></tr>';e.rows.add($(n)).draw()}))}}),$('.dataTables_filter input[type="search"]').attr("placeholder","Search anything!").css({width:"300px",display:"inline-block",background:"white"}),$('.dataTables_filter input[type="search"]').attr("class","btn btn-round").css({width:"300px",display:"inline-block",color:"#000000",background:"#FFFFFA"}),$(".dataTables_length select").attr("class","btn btn-round").css({width:"80px","background-color":"white",color:"#000000",background:"#FFFFFA"}),$(".d").show(),$("#dtBasicExampled").show()},assignedDeliveries=()=>{$("#dtBasicExample").hide(),$(".a").hide(),$("#dtBasicExampleAp").hide(),$("#dtBasicExampleNew").hide(),$(".b").hide(),$(".c").hide(),$(".d").hide(),$(".e").hide(),$("#dtBasicExampled").hide(),$("#deliveryCreate").hide();var e=$("#dtBasicExampleNew").DataTable({processing:!0,destroy:!0});e.clear().draw(),$.ajax({async:!1,type:"GET",cors:!0,contentType:"application/json",secure:!0,crossDomain:!0,url:urlForAll+"delivery/assigned/"+manager_ID,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(t){document.getElementById("twoo").innerHTML="Assigned Deliveries: "+t.data.length;$.each(t.data,(function(a,d){var n="<tr><td>"+t.data[a].delivery_Id+"</td><td>"+t.data[a].assign_delivery_man_name+"</td><td>"+t.data[a].assign_delivery_man_phone+"</td><td>"+t.data[a].sender_name+"</td><td>"+t.data[a].sender_phone_number+"</td><td>"+t.data[a].sender_address+"</td><td>"+t.data[a].receiver_name+"</td><td>"+t.data[a].receiver_phone_number+"</td><td>"+t.data[a].delivery_area+"</td><td>"+t.data[a].receiver_address+"</td><td>"+t.data[a].delivery_type+"</td><td>"+t.data[a].delivery_charge+"</td><td>"+t.data[a].delivery_status+"</td><td>"+t.data[a].payment_method+'</td><td><button id="'+manager_ID+'" name="'+t.data[a].delivery_id+'" class="btn-round btn-outline btn" onclick=invoice(this)>Invoice</button></td><td><button id="modifyButton" value="'+t.data[a].can_modify+'" class="btn-round btn-outline btn" disabled>Unassign</button></td></tr>';e.rows.add($(n)).draw()}))}}),$('.dataTables_filter input[type="search"]').attr("placeholder","Search anything!").css({width:"300px",display:"inline-block",background:"white"}),$('.dataTables_filter input[type="search"]').attr("class","btn btn-round").css({width:"300px",display:"inline-block",color:"#000000",background:"#FFFFFA"}),$(".dataTables_length select").attr("class","btn btn-round").css({width:"80px","background-color":"white",color:"#000000",background:"#FFFFFA"}),$("#dtBasicExampleNew").show(),$(".e").show()},save=e=>{localStorage.setItem("'Accept': 'application/json'",e.id),localStorage.setItem("'Accept': 'application/jsonN'",e.name),window.open("addDeliverToDeliveryMan.html","_blank")};$("#dtBasicExampled").on("click",".assignIt",(function(){orgid=$(this).attr("id"),$t=$(this),deliveryManId=document.getElementById("deliveryManList").value,$("#tick").hide(),$(".circle-loader").removeClass("load-complete"),$("#sure").html("Are you sure?"),$("#myModal").modal()})),$(".btn-ok").click((function(){$("#sure").html("Please wait"),document.getElementById("modalCancel").disabled=!0,document.getElementById("modalApprove").disabled=!0,deliveryManId?$.ajax({async:!0,type:"PUT",url:urlForAll+"delivery/assign/"+orgid+"/"+deliveryManId,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(e){setTimeout((function(){$(".circle-loader").addClass("load-complete"),$("#tick").show(),$("#sure").html("Delivery man assigned!")}),900),setTimeout((function(){$("#myModal").modal("hide");var e=$("#dtBasicExampled").DataTable();e.row($t.parents("tr")).remove().draw(),document.getElementById("onee").innerHTML="Unassigned Deliveries: "+e.column(0).data().length}),2e3),document.getElementById("modalCancel").disabled=!1,document.getElementById("modalApprove").disabled=!1},error:function(e,t,a){document.getElementById("modalCancel").disabled=!1,document.getElementById("modalApprove").disabled=!1,$("#myModal").modal("hide"),$("#myModal2").modal()}}):(document.getElementById("modalCancel").disabled=!1,document.getElementById("modalApprove").disabled=!1,$("#myModal").modal("hide"),$("#myModal23").modal())}));var invoice=e=>{window.open(urlForAll+"reports/delivery/"+e.id+"/"+e.name)};$("#managers2").change((function(){"Cash on Delivery"==$(this).val()?$("#cod").show():$("#cod").hide()})),document.getElementById("createDelivery").addEventListener("click",(function(e){var t,a=document.getElementById("timepicker-12-hr").value,d=document.getElementById("s_name").value,n=document.getElementById("s_number").value,r=document.getElementById("pac-input").value,i=document.getElementById("r_name").value,l=document.getElementById("r_number").value,o=document.getElementById("pac-input2").value,s=document.getElementById("managers2").value,c=document.getElementById("DELIVERY_NOTE").value,m=document.getElementById("deliveryType").value,u=document.getElementById("delivery_charge").value,p=String(document.getElementById("managers").value),y=String(document.getElementById("lat").value),v=String(document.getElementById("longi").value),h=String(document.getElementById("des_lat").value),g=String(document.getElementById("des_longi").value);""==d||""==n||""==r||""==i||""==l||""==o||""==s||""==p?$("#myModalCreateD2").modal("show"):("Cash on Delivery"==s?(product_cost=document.getElementById("product_cost").value,t=JSON.stringify({delivery_status:"",delivery_type:m,sender_address:r,receiver_address:o,sender_phone_number:n,receiver_phone_number:l,sender_name:d,receiver_name:i,payment_method:s,delivery_charge:u,product_cost:product_cost,sender_lat:y,sender_longi:v,receiver_lat:h,receiver_longi:g,pickup_time:a,delivery_note:c,delivery_area:p})):t=JSON.stringify({delivery_status:"",delivery_type:m,sender_address:r,receiver_address:o,sender_phone_number:n,receiver_phone_number:l,sender_name:d,receiver_name:i,payment_method:s,delivery_charge:u,sender_lat:y,sender_longi:v,receiver_lat:h,receiver_longi:g,pickup_time:a,delivery_note:c,delivery_area:p}),$.ajax({type:"POST",url:urlForAll+"delivery/create/"+manager_ID,data:t,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")},success:function(e){$("#tickD2").hide(),$(".circle-loader").removeClass("load-complete"),$("#sureD2").html(""),$("#myModalCreateD1").modal("show"),$("#sureD2").html("Please wait!"),"OK"==e.status?(setTimeout((function(){$(".circle-loader").addClass("load-complete"),$("#tickD2").show(),$("#sureD2").html("Delivery added!")}),2e3),setTimeout((function(){$("#myModalCreateD1").modal("hide")}),4e3),document.getElementById("formD").reset(),$("#cod").hide()):alert("Failed adding delivery: "+e.status+", "+e.errorMessage)},error:function(e,t,a){$("#myModal2").modal("show")}}))}));