<style>
div.hideKoro3{
	display:none;
}
table#dtBasicExample.dataTable tbody tr:hover {
	background-color: #FFFFEA;
    border-color: #0066b3; 
}

table#dtBasicExample.dataTable tbody tr:hover > .sorting_1 {
	background-color: #FFFFEA;
    border-color: #0066b3;
}
table#dtBasicExampleAp.dataTable tbody tr:hover {
	background-color: #FFFFEA;
    border-color: #0066b3;
}

table#dtBasicExampleAp.dataTable tbody tr:hover > .sorting_1 {
	background-color: #FFFFEA;
    border-color: #0066b3;
}
.naV{
 background:#ffcf5c;
}
.row {
  display: flex;
}
.col-md-4 {
  flex-grow: 1;
  text-align: center;

.cool-link {
    display: inline-block;
    color: #000;
    text-decoration: none;
}

#aRow:hover {
  background-color: red;
}
</style>

<link rel="stylesheet" href="static/css/panelLoader.css">
	<div id="loaderMama3" style="margin-top:8%;">
    <div class="multi-spinner-container" style="color:#fff">
      <div class="multi-spinner">
        <div class="multi-spinner">
          <div class="multi-spinner">
            <div class="multi-spinner">
              <div class="multi-spinner">
                <div class="multi-spinner">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
	<h3 style=" font-family: 'Didact Gothic';font-size: 24px;text-align:center;color:#0066b3">Please Wait...</h3>
</div>
	<div class="card naV hideKoro3" id="hideKoro3">
		<div class="card-body table-responsive">
<div class="row">
    <div class="col-md-4"><button class="btn-outline btn-round btn-default btn btn-info" id="oneb" style="width:100%;font-size: 13px" onclick="registeredMan()">Registered Managers</button></div>
    <div class="col-md-4"><button class="btn-outline btn-round btn-default btn btn-info" id="twob" style="width:100%;font-size: 13px" onclick="approvedMan()">Approved Managers</button></div>
    <div class="col-md-4"><button class="btn-outline btn-round btn-default btn btn-info" id="threeb" style="width:100%;font-size: 13px" onclick="unApprovedMan()">Unapproved Managers</button></div>
  </div>
</div>
	<div class="card a">
		<div class="card-body table-responsive a">
		<table id="dtBasicExample" class="stripe hover" style="color:#0066b3;" cellspacing="0" width="100%">
		<thead>
		<tr>
		  <th class="th-sm">ID

		  </th>
		  <th class="th-sm">Manager's Name

		  </th>
		  <th class="th-sm">Manager's Email

		  </th>
		  <th class="th-sm">Can create delivery man?

		  </th>
		  <th class="th-sm">Can create delivery?

		  </th>
		</tr>
	  </thead>
	  <tfoot>
	</table>
	
</div>
</div>

<div class="card b">
		<div class="container" style="background:#ffffff;border-radius:10px;border-color:#0066b3">
			<img src="static/img/loadingApprove/1.png" >
			<img src="static/img/loadingApprove/2.gif" >
			
		<h3 style="text-align:center;color:#0066b3">Approving...</h3>
		</div>
		<script>
			$('.container').hide();
		</script>
		<div class="card-body table-responsive b blur">
		
		<table id="dtBasicExampleAp" class="stripe hover" style="color:#0066b3;" cellspacing="0" width="100%">
		<thead>
		<tr>
		  <th class="th-sm">ID

		  </th>
		  <th class="th-sm">Manager's Name

		  </th>
		  
		  <th class="th-sm">Manager's Email

		  </th>
		  <th class="th-sm">Can create delivery man?

		  </th>
		  <th class="th-sm">Can create delivery?

		  </th>
		  <th class="th-sm">Approve?

		  </th>
		</tr>
	  </thead>
	  <tfoot>
	</table>
	
</div>
</div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
				<h4 class="modal-title" style="color:#0066b3" id="myModalLabel">Approve this manager?</h4>
			</div>
			<div class="modal-body" style="text-align:center">
							
				<div class="circle-loader" style="text-align:center">
				  <div class="checkmark draw" id="tick"></div>
				</div>
				<h4 id="sure" style="color:#0066b3"></h4>
			</div>
			<div class="modal-footer">
				<button type="button" style="color:#0066b3" class="btn btn-outline btn-default" id="modalCancel" data-dismiss="modal">Cancel</button>
				<button type="button" style="color:#0066b3" class="btn btn-outline btn-danger btn-ok" id="modalApprove">Approve</button>
			</div>
		</div>
	</div>
</div>
<div id="myModal2" class="modal fade" data-backdrop="static">
	<div class="modal-dialog modal-confirm">
		<div class="modal-content">
			
			<div class="modal-body text-center">
				<h4 style="color:#0066b3">Ooops!</h4>	
				<p style="color:#0066b3">Something went wrong. Please try again!</p>
				<button class="btn btn-outline btn-danger btn-error" style="color:#0066b3" data-dismiss="modal">Try Again</button>
			</div>
		</div>
	</div>
</div>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css"></link>

<script src="static/js/.js"></script>

<script>
function one1(){
	setTimeout(function() { $('#loaderMama3').fadeOut(); }, 2100);
}
function two2(){
	setTimeout(function() { $('div#hideKoro3').removeClass("hidden");$('#hideKoro3').fadeIn(); }, 2700);
}
function three3(){
	setTimeout(function() {
		document.getElementById('oneb').disabled = true;
		document.getElementById('twob').disabled = false;
		document.getElementById('threeb').disabled = false;
		document.getElementById('oneb').style.fontSize = '14.5px';
		document.getElementById('twob').style.fontSize = '13px';
		document.getElementById('threeb').style.fontSize = '13px';
		$('#dtBasicExampleAp').hide();
		$('#dtBasicExample').hide();
		$('.b').hide();
			var table = $('#dtBasicExample').DataTable( {
			"processing": true,
			"destroy": true,
			"oSearch": { "bSmart": false, "bRegex": true }
			} );
			table.clear().draw();
			//console.log(a);
			$.ajax
			({
				async: true,
				type: "GET",
				url: urlForAll+ "manager/all/manager",
				headers: 
				{
				  'Accept': 'application/json',
				  'Content-Type': 'application/json',
				"Authorization": 'Bearer ' + localStorage.getItem('token')
				},
				success: function(data) 
				{
					document.getElementById('threeb').innerHTML = 'Unapproved Manager';
					document.getElementById('twob').innerHTML = 'Approved Manager'
					document.getElementById('oneb').innerHTML = 'Registered Manager: ' + data.data.length;
					var trHTML = '';
					$.each(data.data, function (i, item) {
					var table_rows = '<tr><td>'+data.data[i].manager_id+'</td><td>'+data.data[i].manager_name+'</td><td>'+data.data[i].manager_email+'</td><td>'+data.data[i].can_create_delivery_man+'</td><td>'+data.data[i].can_create_delivery+'</td></tr>';

					table.rows.add($(table_rows)).draw();
					});
				},
				error: function(XMLHttpRequest, textStatus, errorThrown) {
					
					alert("Something went wrong!");
				}
			})
		$('.dataTables_filter input[type="search"]').
		attr('placeholder','Search anything!').
		css({'width':'300px','display':'inline-block','background':'white'});

		$('.dataTables_filter input[type="search"]').
		attr('class','btn btn-round').
		css({'width':'300px','display':'inline-block','color':'#000000','background':'#FFFFFA'});

		$('.dataTables_length select').
		attr('class','btn btn-round').
		css({'width':'80px','background-color':'white','color':'#000000','background':'#FFFFFA'});

		$('#dtBasicExample').show();
		$('.a').show();
	}, 3600);
}
</script>
<script>
$(document).ready(function() {
	$('#loaderMama3').show();
	//$("#hideKoro").hide();
	one1();
	two2();
	$('.container').hide();
	$('#dtBasicExample').hide();
	$('.a').hide();
	$('.b').hide();
	$.fn.dataTable.ext.classes.sPageButton = 'btn btn-outline btn-round'; // Change Pagination Button Class
	three3();
	window.addEventListener('storage', function(event){
		if (event.key == 'logout-event') { 
			window.location.href="#login";
		}
	});
});
</script>
<script>
	var registeredMan = () => 
	{
		document.getElementById('oneb').disabled = true;
		document.getElementById('twob').disabled = false;
		document.getElementById('threeb').disabled = false;
		document.getElementById('oneb').style.fontSize = '14.5px';
		document.getElementById('twob').style.fontSize = '13px';
		document.getElementById('threeb').style.fontSize = '13px';
		$('#dtBasicExampleAp').hide();
		$('#dtBasicExample').hide();
		$('.b').hide();
			var table = $('#dtBasicExample').DataTable( {
			"processing": true,
			"destroy": true,
			"oSearch": { "bSmart": false, "bRegex": true }
			} );
			table.clear().draw();
			//console.log(a);
			$.ajax
			({
				async: true,
				type: "GET",
				url: urlForAll+ "manager/all/manager",
				headers: 
				{
				  'Accept': 'application/json',
				  'Content-Type': 'application/json',
				"Authorization": 'Bearer ' + localStorage.getItem('token')
				},
				success: function(data) 
				{
					document.getElementById('threeb').innerHTML = 'Unapproved Manager';
					document.getElementById('twob').innerHTML = 'Approved Manager'
					document.getElementById('oneb').innerHTML = 'Registered Manager: ' + data.data.length;
					var trHTML = '';
					$.each(data.data, function (i, item) {
					var table_rows = '<tr><td>'+data.data[i].manager_id+'</td><td>'+data.data[i].manager_name+'</td><td>'+data.data[i].manager_email+'</td><td>'+data.data[i].can_create_delivery_man+'</td><td>'+data.data[i].can_create_delivery+'</td></tr>';

					table.rows.add($(table_rows)).draw();
					});
				},
				error: function(XMLHttpRequest, textStatus, errorThrown) {
					
					alert("Something went wrong!");
				}
			})
		$('.dataTables_filter input[type="search"]').
		attr('placeholder','Search anything!').
		css({'width':'300px','display':'inline-block','background':'white'});

		$('.dataTables_filter input[type="search"]').
		attr('class','btn btn-round').
		css({'width':'300px','display':'inline-block','color':'#000000','background':'#FFFFFA'});

		$('.dataTables_length select').
		attr('class','btn btn-round').
		css({'width':'80px','background-color':'white','color':'#000000','background':'#FFFFFA'});

		$('#dtBasicExample').show();
		$('.a').show();
	};
	var approvedMan = () =>
	{
		document.getElementById('twob').disabled = true;
		document.getElementById('oneb').disabled = false;
		document.getElementById('threeb').disabled = false;
		document.getElementById('twob').style.fontSize = '14.5px';
		document.getElementById('oneb').style.fontSize = '13px';
		document.getElementById('threeb').style.fontSize = '13px';
		$('#dtBasicExampleAp').hide();
		$('.b').hide();
			var table = $('#dtBasicExample').DataTable( {
			"processing": true,
			"destroy": true,
			"oSearch": { "bSmart": false, "bRegex": true }
			} );
			table.clear().draw();
			var z=0;
			//console.log(a);
			$.ajax
				({
					async: true,
					type: "GET",
					url: urlForAll+ "manager/all/approve/manager",
					headers: 
					{
					  'Accept': 'application/json',
					  'Content-Type': 'application/json',
					"Authorization": 'Bearer ' + localStorage.getItem('token')
					},
					success: function(data) 
					{
						document.getElementById('oneb').innerHTML = 'Registered Manager';
						document.getElementById('threeb').innerHTML = 'Unapproved Manager'
						document.getElementById('twob').innerHTML = 'Approved Manager: ' + data.data.length;
						var trHTML = '';
						$.each(data.data, function (i, item) {
						var table_rows = '<tr><td>'+data.data[i].manager_id+'</td><td>'+data.data[i].manager_name+'</td><td>'+data.data[i].manager_email+'</td><td>'+data.data[i].can_create_delivery_man+'</td><td>'+data.data[i].can_create_delivery+'</td></tr>';

						table.rows.add($(table_rows)).draw();
						});
						z++;
					},
					error: function(XMLHttpRequest, textStatus, errorThrown) {
						
						alert("Something went wrong!");
					}
				})
		$('.dataTables_filter input[type="search"]').
		attr('placeholder','Search anything!').
		css({'width':'300px','display':'inline-block','background':'white'});

		$('.dataTables_filter input[type="search"]').
		attr('class','btn btn-round').
		css({'width':'300px','display':'inline-block','color':'#000000','background':'#FFFFFA'});

		$('.dataTables_length select').
		attr('class','btn btn-round').
		css({'width':'80px','background-color':'white','color':'#000000','background':'#FFFFFA'});

		$('#dtBasicExample').show();
		$('.a').show();
	}
	
	var unApprovedMan = () => 
	{
		document.getElementById('threeb').disabled = true;
		document.getElementById('twob').disabled = false;
		document.getElementById('oneb').disabled = false;
		document.getElementById('threeb').style.fontSize = '14.5px';
		document.getElementById('twob').style.fontSize = '13px';
		document.getElementById('oneb').style.fontSize = '13px';
		$('#dtBasicExample').hide();
		$('.a').hide();
			var table = $('#dtBasicExampleAp').DataTable( {
			"processing": true,
			"destroy": true,
			"oSearch": { "bSmart": false, "bRegex": true }
			} );
			table.clear().draw();
			var z=0;
			$.ajax
				({
					async: true,
					type: "GET",
					url: urlForAll+ "manager/all/unapprove/manager",
					headers: 
					{
					  'Accept': 'application/json',
					  'Content-Type': 'application/json',
						"Authorization": 'Bearer ' + localStorage.getItem('token')
					},
					success: function(data) 
					{
						document.getElementById('oneb').innerHTML = 'Registered Manager';
						document.getElementById('twob').innerHTML = 'Approved Manager'
						document.getElementById('threeb').innerHTML = 'Unapproved Manager: ' + data.data.length;
						
						var trHTML = '';
						$.each(data.data, function (i, item) {
						var table_rows = '<tr><td>'+
						data.data[i].manager_id+'</td><td>'+data.data[i].manager_name+
						'</td><td>'+data.data[i].manager_email+'</td><td>'
						+data.data[i].can_create_delivery_man+'</td><td>'
						+data.data[i].can_create_delivery
						+'</td><td>'
						+'<button id="' + data.data[i].manager_id + '" name="' + data.data[i].org_id + '" class="deleteIt btn-round btn-outline btn">Approve</button></td></tr>';
						table.rows.add($(table_rows)).draw();
						});
						z++;
					},
					error: function(XMLHttpRequest, textStatus, errorThrown) {
						
						alert("Something went wrong!");
					}
				});
				
				$('#dtBasicExampleAp').show();
				$('.b').show();
		
		$('.dataTables_filter input[type="search"]').
		attr('placeholder','Search anything!').
		css({'width':'300px','display':'inline-block','background':'white'});

		$('.dataTables_filter input[type="search"]').
		attr('class','btn btn-round').
		css({'width':'300px','display':'inline-block','color':'#000000','background':'#FFFFFA'});

		$('.dataTables_length select').
		attr('class','btn btn-round').
		css({'width':'80px','background-color':'white','color':'#000000','background':'#FFFFFA'});

		$('#dtBasicExampleAp').show();
		$('.b').show();
	};
					 
	/*var approveByID = (id) => 
	{
		$.ajax
		({
			type: "GET",
			
			url: urlForAll+ "approved/manager/" + id.name + "/" + id.id,
			
			headers:
			{
			  'Accept': 'application/json',
			  'Content-Type': 'application/json',
			  "Authorization": 'Bearer ' + localStorage.getItem('token')
			},
			success: function(data) 
			{
				console.log(data);
			},
			error: function(XMLHttpRequest, textStatus, errorThrown) {
				 alert("Some Error Has Occured, Please Wait!");
			}
		});
	};*/
	var id;
	var name;
	var $t;
	$('#dtBasicExampleAp').on('click', '.deleteIt', function () 
	{
		id = $(this).attr('id');
		name = $(this).attr('name');
		$t = $(this);
		
		$('#tick').hide();
		$(".circle-loader").removeClass("load-complete");
	
		$("#sure").html("Are you sure?");
		$("#myModal").modal();
		
		//$(".container").show();
		
		//document.getElementsByClassName('blur')[0].style.filter = "blur(8px)";
	});
	$('.btn-ok').click(function(){
	$("#sure").html("Please wait!");
	
	document.getElementById('modalCancel').disabled = true;
	document.getElementById('modalApprove').disabled = true;
	$.ajax
		({
			async: true,
			type: "GET",
			
			url: urlForAll+ "approved/manager/" + name + "/" + id,
			
			headers: 
			{
			  'Accept': 'application/json',
			  'Content-Type': 'application/json',
			  "Authorization": 'Bearer ' + localStorage.getItem('token')
			},
			success: function(data) 
			{
				setTimeout(function(){ 
					$(".circle-loader").addClass("load-complete");
					
					$('#tick').show();
					
					$("#sure").html("Manager approved!");
				}, 900);
				setTimeout(function(){
					$("#myModal").modal('hide');
					
					var table = $('#dtBasicExampleAp').DataTable();
					table
					.row($t.parents('tr'))
					.remove()
					.draw();
					document.getElementById('threeb').innerHTML = 'Unapproved Manager: ' + table
																								.column( 0 )
																								.data()
																								.length;
																		
					document.getElementById('modalCancel').disabled = false;
					document.getElementById('modalApprove').disabled = false;						
					}, 2000);

			},
			error: function(XMLHttpRequest, textStatus, errorThrown) {
				
				document.getElementById('modalCancel').disabled = false;
				document.getElementById('modalApprove').disabled = false;
				$('#myModal').modal('hide');
				$('#myModal2').modal();
			}
		});
	});
</script>